<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- ========== WIZARD PRINCIPAL DE ASIGNACI√ìN MASIVA MEJORADO ========== -->
        <record id="view_mass_assignment_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.assignment.wizard.v2.form</field>
            <field name="model">lims.mass.assignment.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignaci√≥n Masiva">
                    <sheet>
                        <div class="oe_title">
                            <h1>üéØ Asignaci√≥n Masiva</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <div class="alert alert-info" style="margin: 20px 0;">
                            <strong>‚ö° Herramientas de Productividad:</strong><br/>
                            Selecciona el tipo de asignaci√≥n que deseas realizar para aplicar 
                            cambios a todos los par√°metros seleccionados de una vez.
                        </div>

                        <!-- AN√ÅLISIS DE PAR√ÅMETROS SELECCIONADOS -->
                        <group string="üìä An√°lisis de Par√°metros Seleccionados" colspan="4">
                            <div class="row">
                                <div class="col-6">
                                    <div style="background: #e8f5e8; padding: 15px; border-radius: 5px; margin: 5px;">
                                        <h4 style="margin-bottom: 10px;">üìà Distribuci√≥n por Tipo y Categor√≠a</h4>
                                        <field name="parameters_by_type_info" readonly="1" nolabel="1"
                                            widget="text" style="font-family: monospace; background: transparent;"/>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 5px;">
                                        <h4 style="margin-bottom: 10px;">üìä Estados y Asignaciones</h4>
                                        <field name="parameters_by_status_info" readonly="1" nolabel="1"
                                            widget="text" style="font-family: monospace; background: transparent;"/>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE COMPLETO DE PAR√ÅMETROS -->
                        <group string="üìã Detalle Completo de Par√°metros" colspan="4">
                            <field name="parameters_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #fff3cd; padding: 15px; border-radius: 5px;"/>
                        </group>
                        
                        <group string="üéõÔ∏è Tipo de Asignaci√≥n" colspan="4">
                            <field name="assignment_type" widget="radio" required="1"/>
                        </group>
                        
                        <!-- Lista resumida de par√°metros seleccionados -->
                        <group string="üìã Par√°metros Seleccionados (Vista R√°pida)" invisible="parameters_count == 0" colspan="4">
                            <field name="parameter_analysis_ids" nolabel="1" readonly="1">
                                <list string="Par√°metros">
                                    <field name="name"/>
                                    <field name="microorganism"/>
                                    <field name="result_type"/>
                                    <field name="analysis_status_checkbox"/>
                                    <field name="analyst_id"/>
                                    <field name="result_value"/>
                                </list>
                            </field>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚ñ∂Ô∏è Continuar" 
                                name="action_open_specific_wizard" 
                                type="object" 
                                class="btn-primary"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE ASIGNACI√ìN MASIVA DE ANALISTAS MEJORADO ========== -->
        <record id="view_mass_analyst_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.analyst.wizard.v2.form</field>
            <field name="model">lims.mass.analyst.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignar Analista Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üë§ Asignaci√≥n Masiva de Analista</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <!-- INFORMACI√ìN ACTUAL -->
                        <group string="üìä Estado Actual de Asignaciones" colspan="4">
                            <div class="row">
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="parameters_without_analyst_count" readonly="1"/>
                                        </div>
                                        <small>Sin Analista</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-info">
                                            <field name="parameters_with_analyst_count" readonly="1"/>
                                        </div>
                                        <small>Ya Tienen Analista</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-warning">
                                            <field name="will_override_count" readonly="1"/>
                                        </div>
                                        <small>Se Sobrescribir√°n</small>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE DE ASIGNACIONES ACTUALES -->
                        <group string="üìã Asignaciones Actuales" 
                            invisible="parameters_with_analyst_count == 0">
                            <field name="current_assignments_info" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>

                        <!-- ADVERTENCIA SI VA A SOBRESCRIBIR -->
                        <div class="alert alert-warning" 
                            invisible="will_override_count == 0" 
                            style="margin: 15px 0;">
                            <strong>‚ö†Ô∏è Advertencia:</strong><br/>
                            Se sobrescribir√°n <field name="will_override_count" readonly="1"/> asignaciones existentes.
                            Revise la informaci√≥n actual antes de continuar.
                        </div>
                        
                        <!-- CONFIGURACI√ìN DEL NUEVO ANALISTA -->
                        <group string="üë§ Selecci√≥n de Analista" colspan="2">
                            <group>
                                <field name="analyst_id" 
                                    placeholder="Seleccionar analista responsable..." 
                                    required="1"
                                    options="{'no_create': True}"/>
                            </group>
                            <group>
                                <!-- Informaci√≥n del analista seleccionado -->
                                <div invisible="not analyst_id" style="background: #e8f5e8; padding: 10px; border-radius: 5px;">
                                    <strong>Analista Seleccionado:</strong><br/>
                                    <span><field name="analyst_id" readonly="1" nolabel="1"/></span>
                                </div>
                            </group>
                        </group>

                        <!-- VERIFICACI√ìN DE SEGURIDAD -->
                        <group string="üîí Verificaci√≥n de Seguridad" colspan="2">
                            <group>
                                <field name="verify_pin"/>
                            </group>
                            <group>
                                <field name="pin_code" 
                                    password="1" 
                                    placeholder="Ingrese PIN del analista"
                                    invisible="verify_pin == False"
                                    required="verify_pin == True"/>
                            </group>
                        </group>

                        <!-- INFORMACI√ìN DE SEGURIDAD -->
                        <div class="alert alert-info" 
                            invisible="verify_pin == False" 
                            style="margin: 15px 0;">
                            <strong>üîí Verificaci√≥n de Seguridad:</strong><br/>
                            Para garantizar la trazabilidad del laboratorio, se requiere verificaci√≥n PIN 
                            del analista que ser√° asignado como responsable.
                            <br/><small>üîê El PIN ser√° validado contra el sistema de autenticaci√≥n del laboratorio.</small>
                        </div>
                        
                        <!-- OPCIONES DE CONFIGURACI√ìN -->
                        <group string="‚öôÔ∏è Opciones de Asignaci√≥n">
                            <field name="override_existing"/>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Confirmar Asignaci√≥n" 
                                name="action_assign_analyst" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de asignar este analista a todos los par√°metros seleccionados?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE ASIGNACI√ìN MASIVA DE MEDIOS MEJORADO ========== -->
        <record id="view_mass_media_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.media.wizard.v2.form</field>
            <field name="model">lims.mass.media.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignar Medios Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üß™ Asignaci√≥n Masiva de Medios</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <group string="üî¨ Configuraci√≥n del Proceso">
                            <field name="process_type" required="1"/>
                            <field name="assignment_method" widget="radio" required="1"/>
                        </group>
                        
                        <!-- INFORMACI√ìN ACTUAL DE MEDIOS -->
                        <group string="üìä Estado Actual de Medios" colspan="4" 
                            invisible="not process_type">
                            <div class="row">
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="parameters_without_media_count" readonly="1"/>
                                        </div>
                                        <small>Sin Medios del Proceso</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-info">
                                            <field name="parameters_with_media_count" readonly="1"/>
                                        </div>
                                        <small>Ya Tienen Medios</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-warning">
                                            <field name="total_media_will_be_affected" readonly="1"/>
                                        </div>
                                        <small>Medios que se Eliminar√°n</small>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE DE MEDIOS ACTUALES -->
                        <group string="üìã Medios Actuales por Par√°metro" 
                            invisible="parameters_with_media_count == 0">
                            <field name="current_media_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>

                        <!-- ADVERTENCIA SI VA A LIMPIAR MEDIOS -->
                        <div class="alert alert-warning" 
                            invisible="total_media_will_be_affected == 0 or clear_existing_media == False" 
                            style="margin: 15px 0;">
                            <strong>‚ö†Ô∏è Advertencia:</strong><br/>
                            Se eliminar√°n <field name="total_media_will_be_affected" readonly="1"/> medios existentes 
                            del proceso <field name="process_type" readonly="1"/>.
                            <br/>Revise la informaci√≥n actual antes de continuar.
                        </div>
                        
                        <!-- Para sets de medios -->
                        <group string="üì¶ Set de Medios" invisible="assignment_method != 'media_set'">
                            <field name="media_set_id" 
                                placeholder="Seleccionar set predefinido..."
                                required="assignment_method == 'media_set'"
                                options="{'no_create': True}"/>
                        </group>
                        
                        <!-- Para medios individuales -->
                        <group string="üß™ Medios Individuales" invisible="assignment_method != 'individual_media'">
                            <field name="selected_media_ids" widget="many2many_tags"
                                placeholder="Seleccionar medios..."
                                required="assignment_method == 'individual_media'"/>
                            <field name="media_usage" 
                                required="assignment_method == 'individual_media'"/>
                        </group>
                        
                        <!-- Para copiar desde otro par√°metro -->
                        <group string="üìã Copiar desde Par√°metro" invisible="assignment_method != 'copy_from_parameter'">
                            <field name="source_parameter_id" 
                                placeholder="Seleccionar par√°metro fuente..."
                                required="assignment_method == 'copy_from_parameter'"
                                options="{'no_create': True}"/>
                        </group>
                        
                        <group string="‚öôÔ∏è Opciones">
                            <field name="include_incubation_settings"/>
                            <field name="clear_existing_media"/>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Asignar Medios" 
                                name="action_assign_media" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de asignar estos medios a todos los par√°metros seleccionados?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE ASIGNACI√ìN MASIVA DE FECHAS MEJORADO ========== -->
        <record id="view_mass_dates_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.dates.wizard.v2.form</field>
            <field name="model">lims.mass.dates.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignar Fechas Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üìÖ Asignaci√≥n Masiva de Fechas</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <group string="üìÖ Tipo de Fechas">
                            <field name="date_type" widget="radio" required="1"/>
                        </group>

                        <!-- INFORMACI√ìN ACTUAL DE FECHAS -->
                        <group string="üìä Estado Actual de Fechas" colspan="4" 
                            invisible="not date_type">
                            <div class="row">
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="parameters_without_dates_count" readonly="1"/>
                                        </div>
                                        <small>Sin Fechas</small>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-info">
                                            <field name="parameters_with_dates_count" readonly="1"/>
                                        </div>
                                        <small>Ya Tienen Fechas</small>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE DE FECHAS ACTUALES -->
                        <group string="üìã Fechas Actuales" 
                            invisible="parameters_with_dates_count == 0">
                            <field name="current_dates_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>

                        <!-- ADVERTENCIA SI VA A SOBRESCRIBIR -->
                        <div class="alert alert-warning" 
                            invisible="parameters_with_dates_count == 0 or override_existing == False" 
                            style="margin: 15px 0;">
                            <strong>‚ö†Ô∏è Advertencia:</strong><br/>
                            Se sobrescribir√°n fechas existentes en <field name="parameters_with_dates_count" readonly="1"/> par√°metros.
                            <br/>Revise la informaci√≥n actual antes de continuar.
                        </div>
                        
                        <!-- Fechas generales -->
                        <group string="üìÖ Fechas de An√°lisis General" 
                            invisible="date_type != 'analysis_dates'" colspan="2">
                            <group>
                                <field name="analysis_start_date"/>
                            </group>
                            <group>
                                <field name="analysis_commitment_date"/>
                            </group>
                        </group>
                        
                        <!-- Fechas de procesos -->
                        <group string="üî¨ Fechas de Procesos Espec√≠ficos" 
                            invisible="date_type != 'process_dates'" colspan="2">
                            <group>
                                <field name="process_type" required="date_type == 'process_dates'"/>
                                <field name="processing_date" required="date_type == 'process_dates'"/>
                            </group>
                            <group>
                                <field name="processing_time" placeholder="HH:MM"/>
                            </group>
                        </group>
                        
                        <group string="‚öôÔ∏è Opciones">
                            <field name="override_existing"/>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Asignar Fechas" 
                                name="action_assign_dates" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de asignar estas fechas a todos los par√°metros seleccionados?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE ASIGNACI√ìN MASIVA DE EQUIPOS MEJORADO ========== -->
        <record id="view_mass_equipment_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.equipment.wizard.v2.form</field>
            <field name="model">lims.mass.equipment.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignar Equipos Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üîß Asignaci√≥n Masiva de Equipos</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <group string="üîß Tipo de Equipo">
                            <field name="equipment_type" widget="radio" required="1"/>
                        </group>

                        <!-- INFORMACI√ìN ACTUAL DE EQUIPOS -->
                        <group string="üìä Estado Actual de Equipos" colspan="4" 
                            invisible="not equipment_type">
                            <div class="row">
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="parameters_without_equipment_count" readonly="1"/>
                                        </div>
                                        <small>Sin Equipos</small>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-info">
                                            <field name="parameters_with_equipment_count" readonly="1"/>
                                        </div>
                                        <small>Ya Tienen Equipos</small>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE DE EQUIPOS ACTUALES -->
                        <group string="üìã Equipos Actuales por Par√°metro" 
                            invisible="parameters_with_equipment_count == 0">
                            <field name="current_equipment_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>

                        <!-- ADVERTENCIA SI VA A SOBRESCRIBIR -->
                        <div class="alert alert-warning" 
                            invisible="parameters_with_equipment_count == 0 or override_existing == False" 
                            style="margin: 15px 0;">
                            <strong>‚ö†Ô∏è Advertencia:</strong><br/>
                            Se sobrescribir√°n equipos existentes en <field name="parameters_with_equipment_count" readonly="1"/> par√°metros.
                            <br/>Revise la informaci√≥n actual antes de continuar.
                        </div>
                        
                        <!-- Equipos de procesamiento -->
                        <group string="üè≠ Equipos de Procesamiento" 
                            invisible="equipment_type != 'processing_equipment'" colspan="2">
                            <group>
                                <field name="process_type" required="equipment_type == 'processing_equipment'"/>
                            </group>
                            <group>
                                <field name="processing_equipment_id" 
                                    required="equipment_type == 'processing_equipment'"
                                    placeholder="Seleccionar equipo..."/>
                            </group>
                        </group>
                        
                        <!-- Equipos de incubaci√≥n -->
                        <group string="üå°Ô∏è Equipos de Incubaci√≥n" 
                            invisible="equipment_type != 'incubation_equipment'" colspan="2">
                            <group>
                                <field name="incubation_process_type" required="equipment_type == 'incubation_equipment'"/>
                            </group>
                            <group>
                                <field name="incubation_equipment_id" 
                                    required="equipment_type == 'incubation_equipment'"
                                    placeholder="Seleccionar incubadora..."/>
                            </group>
                        </group>
                        
                        <!-- Equipos adicionales -->
                        <group string="‚öôÔ∏è Equipos Adicionales" 
                            invisible="equipment_type != 'additional_equipment'" colspan="2">
                            <group>
                                <field name="additional_equipment_id" 
                                    required="equipment_type == 'additional_equipment'"
                                    placeholder="Seleccionar equipo..."/>
                                <field name="equipment_usage" 
                                    required="equipment_type == 'additional_equipment'"
                                    placeholder="Especificar uso del equipo"/>
                            </group>
                            <group>
                                <field name="usage_date"/>
                                <field name="used_by_name"/>
                            </group>
                        </group>
                        
                        <group string="‚öôÔ∏è Opciones">
                            <field name="override_existing"/>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Asignar Equipos" 
                                name="action_assign_equipment" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de asignar estos equipos a todos los par√°metros seleccionados?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE CAMBIO MASIVO DE ESTADOS MEJORADO ========== -->
        <record id="view_mass_status_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.status.wizard.v2.form</field>
            <field name="model">lims.mass.status.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Cambiar Estados Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üìä Cambio Masivo de Estados</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <group string="üìä Tipo de Estado">
                            <field name="status_type" widget="radio" required="1"/>
                        </group>

                        <!-- DISTRIBUCI√ìN DE ESTADOS ACTUALES -->
                        <group string="üìä Distribuci√≥n de Estados Actuales" colspan="4" 
                            invisible="not status_type">
                            <field name="parameters_by_status_info" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #e8f5e8; padding: 10px;"/>
                        </group>

                        <!-- DETALLE DE ESTADOS ACTUALES -->
                        <group string="üìã Estados Actuales por Par√°metro" colspan="4">
                            <field name="current_status_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>
                        
                        <!-- Estados de an√°lisis -->
                        <group string="üî¨ Nuevo Estado de An√°lisis" 
                            invisible="status_type != 'analysis_status'">
                            <field name="new_analysis_status" 
                                required="status_type == 'analysis_status'"
                                widget="radio"/>
                        </group>
                        
                        <!-- Estados de reporte -->
                        <group string="üìÑ Nuevo Estado de Reporte" 
                            invisible="status_type != 'report_status'">
                            <field name="new_report_status" 
                                required="status_type == 'report_status'"
                                widget="radio"/>
                        </group>
                        
                        <!-- Configuraci√≥n de procesos -->
                        <group string="‚öôÔ∏è Nueva Configuraci√≥n de Procesos Requeridos" 
                            invisible="status_type != 'process_requirements'" colspan="2">
                            <group>
                                <field name="requires_pre_enrichment"/>
                                <field name="requires_selective_enrichment"/>
                            </group>
                            <group>
                                <field name="requires_confirmation"/>
                                <field name="requires_ph_adjustment"/>
                            </group>
                        </group>
                        
                        <group string="üéØ Criterios de Aplicaci√≥n">
                            <field name="apply_to_filter" widget="radio"/>
                        </group>
                        
                        <!-- Filtros espec√≠ficos -->
                        <group string="üîç Filtros" colspan="2" 
                            invisible="apply_to_filter == 'all_selected'">
                            <group invisible="apply_to_filter != 'by_current_status'">
                                <field name="current_status_filter" 
                                    required="apply_to_filter == 'by_current_status'"/>
                            </group>
                            <group invisible="apply_to_filter != 'by_result_type'">
                                <field name="result_type_filter" 
                                    required="apply_to_filter == 'by_result_type'"/>
                            </group>
                        </group>

                        <!-- RESUMEN DE CAMBIOS -->
                        <group string="üìà Resumen de Cambios" colspan="4">
                            <div class="row">
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="will_change_count" readonly="1"/>
                                        </div>
                                        <small>Par√°metros que Cambiar√°n</small>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="text-center">
                                        <div class="h2 text-muted">
                                            <field name="will_remain_count" readonly="1"/>
                                        </div>
                                        <small>Sin Cambios</small>
                                    </div>
                                </div>
                            </div>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Cambiar Estados" 
                                name="action_change_status" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de cambiar los estados seg√∫n la configuraci√≥n especificada?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!-- ========== WIZARD DE ASIGNACI√ìN MASIVA DE AMBIENTES MEJORADO ========== -->
        <record id="view_mass_environment_wizard_form" model="ir.ui.view">
            <field name="name">lims.mass.environment.wizard.v2.form</field>
            <field name="model">lims.mass.environment.wizard.v2</field>
            <field name="arch" type="xml">
                <form string="Asignar Ambientes Masivamente">
                    <sheet>
                        <div class="oe_title">
                            <h1>üè≠ Asignaci√≥n Masiva de Ambientes</h1>
                            <h3 class="text-success">
                                <field name="parameters_count" readonly="1"/> par√°metros seleccionados
                            </h3>
                        </div>
                        
                        <group string="üî¨ Configuraci√≥n del Proceso">
                            <field name="process_type" required="1"/>
                            <field name="environment" widget="radio" required="1"/>
                        </group>

                        <!-- INFORMACI√ìN ACTUAL DE AMBIENTES -->
                        <group string="üìä Estado Actual de Ambientes" colspan="4" 
                            invisible="not process_type">
                            <div class="row">
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-success">
                                            <field name="parameters_without_environment_count" readonly="1"/>
                                        </div>
                                        <small>Sin Ambiente</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-info">
                                            <field name="parameters_with_environment_count" readonly="1"/>
                                        </div>
                                        <small>Ya Tienen Ambiente</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-center">
                                        <div class="h2 text-warning">
                                            <field name="filtered_parameters_count" readonly="1"/>
                                        </div>
                                        <small>Aplicar√°n Cambios</small>
                                    </div>
                                </div>
                            </div>
                        </group>

                        <!-- DETALLE DE AMBIENTES ACTUALES -->
                        <group string="üìã Ambientes Actuales por Par√°metro" 
                            invisible="parameters_with_environment_count == 0">
                            <field name="current_environment_summary" readonly="1" nolabel="1"
                                widget="text" style="font-family: monospace; background: #f8f9fa; padding: 10px;"/>
                        </group>

                        <!-- ADVERTENCIA SI VA A SOBRESCRIBIR -->
                        <div class="alert alert-warning" 
                            invisible="parameters_with_environment_count == 0 or override_existing == False" 
                            style="margin: 15px 0;">
                            <strong>‚ö†Ô∏è Advertencia:</strong><br/>
                            Se sobrescribir√°n ambientes existentes en <field name="parameters_with_environment_count" readonly="1"/> par√°metros.
                            <br/>Revise la informaci√≥n actual antes de continuar.
                        </div>
                        
                        <!-- Equipo espec√≠fico para campanas -->
                        <group string="üîß Equipo Espec√≠fico" 
                            invisible="environment not in ['campana_flujo', 'campana_bioseguridad']">
                            <field name="specific_equipment_id" 
                                placeholder="Seleccionar equipo espec√≠fico..."
                                help="Opcional: Asignar un equipo espec√≠fico"/>
                        </group>
                        
                        <group string="üéØ Criterios de Aplicaci√≥n">
                            <field name="filter_by_result_type"/>
                            <field name="result_type_filter" 
                                invisible="filter_by_result_type == False"
                                required="filter_by_result_type == True"/>
                        </group>
                        
                        <group string="‚öôÔ∏è Opciones">
                            <field name="override_existing"/>
                        </group>
                        
                    </sheet>
                    
                    <footer>
                        <button string="‚úÖ Asignar Ambientes" 
                                name="action_assign_environment" 
                                type="object" 
                                class="btn-primary"
                                confirm="¬øEst√° seguro de asignar estos ambientes a todos los par√°metros seleccionados?"/>
                        <button string="‚ùå Cancelar" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

    </data>
</odoo>